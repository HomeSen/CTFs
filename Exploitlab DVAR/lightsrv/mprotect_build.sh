#!/bin/bash

# assemble object file
as mprotect.s -o mprotect.o

# link against stripped down libc.so, ignore missing symbol
ld -o mprotect mprotect.o /lib/libc.so -dynamic-linker /lib/ld-musl-armhf.so.1 --ignore-unresolved-symbol mprotect

# start gdbserver for inspection
gdbserver :5000 ./mprotect

# in GDB:
# gef> print mprotect
# $1 = {<text variable, no debug info>} 0x10154 <mprotect@plt>
